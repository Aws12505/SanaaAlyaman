import{r as C,u as U,j as e,H as L}from"./app-Cxt0utQE.js";import{C as x,a as h,b as p,c as g,d as u}from"./card-CH0fhSIt.js";import{B as j,X as P}from"./index-Cxe2JAIB.js";import{I as f}from"./input-vM-Ex7my.js";import{L as d}from"./label-B7-htNwP.js";import{T as N}from"./textarea-BIGcLUVl.js";import{U as B,S as v}from"./switch-fkgsq0Lk.js";import{S as H,a as T,b as M,c as R,d as z}from"./select-CjjITk3P.js";import{A as V}from"./app-layout-Bxadt-Zd.js";import{A as O}from"./arrow-left-CcXWulZj.js";import{C as S}from"./camera-D8_OnLsz.js";import"./app-B88Y09HE.js";import"./createLucideIcon-Db5qSUaR.js";import"./index-BEk2UiLn.js";import"./check-qGtoZ9Xk.js";function de({dish:r,categories:b}){const[n,y]=C.useState(r.images||[]),[D,_]=C.useState([]),F=[{title:"Dashboard",href:"/admin"},{title:"Dishes",href:"/admin/dishes"},{title:r.name,href:`/admin/dishes/${r.id}`},{title:"Edit",href:`/admin/dishes/${r.id}/edit`}],{data:i,setData:t,put:I,processing:w,errors:a}=U({name:r.name,description:r.description,ingredients:r.ingredients||"",allergen_info:r.allergen_info||"",price:r.price,images:[],category_id:r.category_id,is_signature:r.is_signature,is_featured:r.is_featured,is_available:r.is_available,sort_order:r.sort_order}),k=s=>{const l=Array.from(s.target.files||[]);l.length>0&&(_(c=>[...c,...l]),t("images",[...i.images,...l]),l.forEach(c=>{const o=new FileReader;o.onloadend=()=>{y(m=>[...m,o.result])},o.readAsDataURL(c)}))},A=s=>{const l=n.filter((o,m)=>m!==s);y(l);const c=r.images.length;if(s>=c){const o=s-c,m=D.filter((X,E)=>E!==o);_(m),t("images",m)}},$=s=>{s.preventDefault(),I(`/admin/dishes/${r.id}`,{forceFormData:!0})};return e.jsxs(V,{breadcrumbs:F,children:[e.jsx(L,{title:`Edit ${r.name}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 overflow-x-auto p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:`/admin/dishes/${r.id}`,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Back to Dish"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Dish"}),e.jsx("p",{className:"text-muted-foreground",children:"Update dish information"})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(p,{children:"Basic Information"}),e.jsx(g,{children:"Update essential details about the dish"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Dish Name"}),e.jsx(f,{id:"name",value:i.name,onChange:s=>t("name",s.target.value),placeholder:"Enter dish name",className:a.name?"border-red-500":""}),a.name&&e.jsx("p",{className:"text-sm text-red-600",children:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"category_id",children:"Category"}),e.jsxs(H,{value:i.category_id.toString(),onValueChange:s=>t("category_id",parseInt(s)),children:[e.jsx(T,{className:a.category_id?"border-red-500":"",children:e.jsx(M,{placeholder:"Select a category"})}),e.jsx(R,{children:b.map(s=>e.jsx(z,{value:s.id.toString(),children:s.name},s.id))})]}),a.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:a.category_id})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx(N,{id:"description",value:i.description,onChange:s=>t("description",s.target.value),placeholder:"Describe the dish",rows:4,className:a.description?"border-red-500":""}),a.description&&e.jsx("p",{className:"text-sm text-red-600",children:a.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"ingredients",children:"Ingredients"}),e.jsx(N,{id:"ingredients",value:i.ingredients,onChange:s=>t("ingredients",s.target.value),placeholder:"List the main ingredients",rows:3,className:a.ingredients?"border-red-500":""}),a.ingredients&&e.jsx("p",{className:"text-sm text-red-600",children:a.ingredients})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"allergen_info",children:"Allergen Information"}),e.jsx(N,{id:"allergen_info",value:i.allergen_info,onChange:s=>t("allergen_info",s.target.value),placeholder:"List allergens and dietary information",rows:2,className:a.allergen_info?"border-red-500":""}),a.allergen_info&&e.jsx("p",{className:"text-sm text-red-600",children:a.allergen_info})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"price",children:"Price ($)"}),e.jsx(f,{id:"price",type:"number",step:"0.01",value:i.price,onChange:s=>t("price",parseFloat(s.target.value)),placeholder:"0.00",className:a.price?"border-red-500":""}),a.price&&e.jsx("p",{className:"text-sm text-red-600",children:a.price})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"sort_order",children:"Sort Order"}),e.jsx(f,{id:"sort_order",type:"number",value:i.sort_order,onChange:s=>t("sort_order",parseInt(s.target.value)),placeholder:"0",className:a.sort_order?"border-red-500":""}),a.sort_order&&e.jsx("p",{className:"text-sm text-red-600",children:a.sort_order})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Dish Images"]}),e.jsx(g,{children:"Current images and add new ones (up to 5 total)"})]}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[n.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.map((s,l)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Preview ${l+1}`,className:"w-full h-32 object-cover rounded-lg"}),e.jsx(j,{type:"button",variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>A(l),children:e.jsx(P,{className:"h-3 w-3"})}),l===0&&e.jsx("div",{className:"absolute bottom-1 left-1 bg-blue-600 text-white text-xs px-2 py-1 rounded",children:"Main"})]},l))}),n.length<5&&e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 text-center",children:[e.jsx(B,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Add more images (",n.length,"/5)"]}),e.jsx(f,{type:"file",accept:"image/*",multiple:!0,onChange:k,className:"max-w-xs mx-auto"})]}),a.images&&e.jsx("p",{className:"text-sm text-red-600",children:a.images})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(p,{children:"Status & Features"}),e.jsx(g,{children:"Update dish availability and special features"})]}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{htmlFor:"is_available",children:"Available"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customers can order this dish"})]}),e.jsx(v,{id:"is_available",checked:i.is_available,onCheckedChange:s=>t("is_available",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{htmlFor:"is_signature",children:"Signature Dish"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mark as one of your signature dishes"})]}),e.jsx(v,{id:"is_signature",checked:i.is_signature,onCheckedChange:s=>t("is_signature",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{htmlFor:"is_featured",children:"Featured Dish"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show in featured section on homepage"})]}),e.jsx(v,{id:"is_featured",checked:i.is_featured,onCheckedChange:s=>t("is_featured",s)})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(j,{type:"button",variant:"outline",asChild:!0,children:e.jsx("a",{href:`/admin/dishes/${r.id}`,children:"Cancel"})}),e.jsx(j,{type:"submit",disabled:w,children:w?"Updating...":"Update Dish"})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(x,{className:"sticky top-6",children:[e.jsxs(h,{children:[e.jsx(p,{children:"Preview"}),e.jsx(g,{children:"How this dish will appear to customers"})]}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:n.length>0?e.jsx("img",{src:n[0],alt:"Main preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:e.jsx(S,{className:"h-8 w-8"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold",children:i.name||"Dish Name"}),i.is_signature&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded",children:"Signature"}),i.is_featured&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:"Featured"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:i.description||"Dish description will appear here"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",i.price.toFixed(2)]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:b.find(s=>s.id===i.category_id)?.name||"Category"})]})]})]})})]})})]})]})]})}export{de as default};
